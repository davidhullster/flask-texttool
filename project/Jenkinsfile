pipeline {
    agent {
      any
    }
    stages {
        stage('Checkout Repo') {
            steps {
                script {
                sh """git clone git@github.com:davidhullster/flask-texttool.git"""
                }
            }
        }
        stage('Install Dependencies') {
          steps {
            script {
                sh """pip install -r requirements.txt"""
            }
          }
        }
        stage('Linting') {
          steps {
            script {
                sh """pylint **/*.py"""
            }
          }
        }
        stage('Testing') {
          steps {
            script {
              sh """ python -m unittest discover -s tests/unit"""
            }
          }
        }
    }
    post {
    failure {
      script {
        msg = "Build error for ${env.JOB_NAME} ${env.BUILD_NUMBER} (${env.BUILD_URL})"
            }
    }
  }
}